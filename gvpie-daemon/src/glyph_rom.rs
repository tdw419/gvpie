/// 5×7 bitmap font ROM
///
/// Each glyph is 5 pixels wide and 7 pixels tall.
/// Stored as u8 arrays where each byte represents a row (5 bits used).

pub const GLYPH_WIDTH: usize = 5;
pub const GLYPH_HEIGHT: usize = 7;

pub struct Glyph {
    pub data: [u8; GLYPH_HEIGHT],
}

impl Glyph {
    pub const fn new(data: [u8; GLYPH_HEIGHT]) -> Self {
        Self { data }
    }

    pub fn is_pixel_set(&self, x: usize, y: usize) -> bool {
        if x >= GLYPH_WIDTH || y >= GLYPH_HEIGHT {
            return false;
        }
        (self.data[y] & (1 << (4 - x))) != 0
    }
}

/// Get glyph for ASCII character
pub fn get_glyph(ch: char) -> &'static Glyph {
    let idx = (ch as usize).min(127);
    &GLYPH_ROM[idx]
}

/// 5×7 ASCII font ROM
/// Format: Each row is a byte, MSB first
pub static GLYPH_ROM: [Glyph; 128] = [
    // 0x00-0x1F: Control characters (blank)
    Glyph::new([0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]), // 0x00
    Glyph::new([0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]), // 0x01
    Glyph::new([0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]), // 0x02
    Glyph::new([0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]), // 0x03
    Glyph::new([0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]), // 0x04
    Glyph::new([0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]), // 0x05
    Glyph::new([0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]), // 0x06
    Glyph::new([0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]), // 0x07
    Glyph::new([0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]), // 0x08
    Glyph::new([0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]), // 0x09
    Glyph::new([0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]), // 0x0A
    Glyph::new([0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]), // 0x0B
    Glyph::new([0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]), // 0x0C
    Glyph::new([0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]), // 0x0D
    Glyph::new([0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]), // 0x0E
    Glyph::new([0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]), // 0x0F
    Glyph::new([0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]), // 0x10
    Glyph::new([0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]), // 0x11
    Glyph::new([0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]), // 0x12
    Glyph::new([0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]), // 0x13
    Glyph::new([0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]), // 0x14
    Glyph::new([0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]), // 0x15
    Glyph::new([0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]), // 0x16
    Glyph::new([0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]), // 0x17
    Glyph::new([0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]), // 0x18
    Glyph::new([0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]), // 0x19
    Glyph::new([0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]), // 0x1A
    Glyph::new([0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]), // 0x1B
    Glyph::new([0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]), // 0x1C
    Glyph::new([0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]), // 0x1D
    Glyph::new([0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]), // 0x1E
    Glyph::new([0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]), // 0x1F

    // 0x20: Space
    Glyph::new([0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]),

    // 0x21: !
    Glyph::new([0x04, 0x04, 0x04, 0x04, 0x00, 0x04, 0x00]),

    // 0x22: "
    Glyph::new([0x0A, 0x0A, 0x00, 0x00, 0x00, 0x00, 0x00]),

    // 0x23: #
    Glyph::new([0x0A, 0x1F, 0x0A, 0x1F, 0x0A, 0x00, 0x00]),

    // 0x24: $
    Glyph::new([0x04, 0x0E, 0x14, 0x0E, 0x05, 0x1E, 0x04]),

    // 0x25: %
    Glyph::new([0x18, 0x19, 0x02, 0x04, 0x08, 0x13, 0x03]),

    // 0x26: &
    Glyph::new([0x08, 0x14, 0x14, 0x08, 0x15, 0x12, 0x0D]),

    // 0x27: '
    Glyph::new([0x04, 0x04, 0x00, 0x00, 0x00, 0x00, 0x00]),

    // 0x28: (
    Glyph::new([0x02, 0x04, 0x08, 0x08, 0x08, 0x04, 0x02]),

    // 0x29: )
    Glyph::new([0x08, 0x04, 0x02, 0x02, 0x02, 0x04, 0x08]),

    // 0x2A: *
    Glyph::new([0x00, 0x04, 0x15, 0x0E, 0x15, 0x04, 0x00]),

    // 0x2B: +
    Glyph::new([0x00, 0x04, 0x04, 0x1F, 0x04, 0x04, 0x00]),

    // 0x2C: ,
    Glyph::new([0x00, 0x00, 0x00, 0x00, 0x00, 0x04, 0x08]),

    // 0x2D: -
    Glyph::new([0x00, 0x00, 0x00, 0x1F, 0x00, 0x00, 0x00]),

    // 0x2E: .
    Glyph::new([0x00, 0x00, 0x00, 0x00, 0x00, 0x04, 0x00]),

    // 0x2F: /
    Glyph::new([0x01, 0x01, 0x02, 0x04, 0x08, 0x10, 0x10]),

    // 0x30-0x39: Digits 0-9
    Glyph::new([0x0E, 0x11, 0x13, 0x15, 0x19, 0x11, 0x0E]), // 0
    Glyph::new([0x04, 0x0C, 0x04, 0x04, 0x04, 0x04, 0x0E]), // 1
    Glyph::new([0x0E, 0x11, 0x01, 0x02, 0x04, 0x08, 0x1F]), // 2
    Glyph::new([0x0E, 0x11, 0x01, 0x0E, 0x01, 0x11, 0x0E]), // 3
    Glyph::new([0x02, 0x06, 0x0A, 0x12, 0x1F, 0x02, 0x02]), // 4
    Glyph::new([0x1F, 0x10, 0x1E, 0x01, 0x01, 0x11, 0x0E]), // 5
    Glyph::new([0x06, 0x08, 0x10, 0x1E, 0x11, 0x11, 0x0E]), // 6
    Glyph::new([0x1F, 0x01, 0x02, 0x04, 0x08, 0x08, 0x08]), // 7
    Glyph::new([0x0E, 0x11, 0x11, 0x0E, 0x11, 0x11, 0x0E]), // 8
    Glyph::new([0x0E, 0x11, 0x11, 0x0F, 0x01, 0x02, 0x0C]), // 9

    // 0x3A-0x40
    Glyph::new([0x00, 0x04, 0x00, 0x00, 0x00, 0x04, 0x00]), // :
    Glyph::new([0x00, 0x04, 0x00, 0x00, 0x00, 0x04, 0x08]), // ;
    Glyph::new([0x02, 0x04, 0x08, 0x10, 0x08, 0x04, 0x02]), // <
    Glyph::new([0x00, 0x00, 0x1F, 0x00, 0x1F, 0x00, 0x00]), // =
    Glyph::new([0x08, 0x04, 0x02, 0x01, 0x02, 0x04, 0x08]), // >
    Glyph::new([0x0E, 0x11, 0x01, 0x02, 0x04, 0x00, 0x04]), // ?
    Glyph::new([0x0E, 0x11, 0x17, 0x15, 0x17, 0x10, 0x0E]), // @

    // 0x41-0x5A: Uppercase A-Z
    Glyph::new([0x0E, 0x11, 0x11, 0x1F, 0x11, 0x11, 0x11]), // A
    Glyph::new([0x1E, 0x11, 0x11, 0x1E, 0x11, 0x11, 0x1E]), // B
    Glyph::new([0x0E, 0x11, 0x10, 0x10, 0x10, 0x11, 0x0E]), // C
    Glyph::new([0x1E, 0x11, 0x11, 0x11, 0x11, 0x11, 0x1E]), // D
    Glyph::new([0x1F, 0x10, 0x10, 0x1E, 0x10, 0x10, 0x1F]), // E
    Glyph::new([0x1F, 0x10, 0x10, 0x1E, 0x10, 0x10, 0x10]), // F
    Glyph::new([0x0E, 0x11, 0x10, 0x17, 0x11, 0x11, 0x0E]), // G
    Glyph::new([0x11, 0x11, 0x11, 0x1F, 0x11, 0x11, 0x11]), // H
    Glyph::new([0x0E, 0x04, 0x04, 0x04, 0x04, 0x04, 0x0E]), // I
    Glyph::new([0x07, 0x02, 0x02, 0x02, 0x02, 0x12, 0x0C]), // J
    Glyph::new([0x11, 0x12, 0x14, 0x18, 0x14, 0x12, 0x11]), // K
    Glyph::new([0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x1F]), // L
    Glyph::new([0x11, 0x1B, 0x15, 0x15, 0x11, 0x11, 0x11]), // M
    Glyph::new([0x11, 0x19, 0x15, 0x13, 0x11, 0x11, 0x11]), // N
    Glyph::new([0x0E, 0x11, 0x11, 0x11, 0x11, 0x11, 0x0E]), // O
    Glyph::new([0x1E, 0x11, 0x11, 0x1E, 0x10, 0x10, 0x10]), // P
    Glyph::new([0x0E, 0x11, 0x11, 0x11, 0x15, 0x12, 0x0D]), // Q
    Glyph::new([0x1E, 0x11, 0x11, 0x1E, 0x14, 0x12, 0x11]), // R
    Glyph::new([0x0E, 0x11, 0x10, 0x0E, 0x01, 0x11, 0x0E]), // S
    Glyph::new([0x1F, 0x04, 0x04, 0x04, 0x04, 0x04, 0x04]), // T
    Glyph::new([0x11, 0x11, 0x11, 0x11, 0x11, 0x11, 0x0E]), // U
    Glyph::new([0x11, 0x11, 0x11, 0x11, 0x11, 0x0A, 0x04]), // V
    Glyph::new([0x11, 0x11, 0x11, 0x15, 0x15, 0x1B, 0x11]), // W
    Glyph::new([0x11, 0x11, 0x0A, 0x04, 0x0A, 0x11, 0x11]), // X
    Glyph::new([0x11, 0x11, 0x0A, 0x04, 0x04, 0x04, 0x04]), // Y
    Glyph::new([0x1F, 0x01, 0x02, 0x04, 0x08, 0x10, 0x1F]), // Z

    // 0x5B-0x60
    Glyph::new([0x0E, 0x08, 0x08, 0x08, 0x08, 0x08, 0x0E]), // [
    Glyph::new([0x10, 0x10, 0x08, 0x04, 0x02, 0x01, 0x01]), // \
    Glyph::new([0x0E, 0x02, 0x02, 0x02, 0x02, 0x02, 0x0E]), // ]
    Glyph::new([0x04, 0x0A, 0x11, 0x00, 0x00, 0x00, 0x00]), // ^
    Glyph::new([0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x1F]), // _
    Glyph::new([0x08, 0x04, 0x00, 0x00, 0x00, 0x00, 0x00]), // `

    // 0x61-0x7A: Lowercase a-z
    Glyph::new([0x00, 0x00, 0x0E, 0x01, 0x0F, 0x11, 0x0F]), // a
    Glyph::new([0x10, 0x10, 0x1E, 0x11, 0x11, 0x11, 0x1E]), // b
    Glyph::new([0x00, 0x00, 0x0E, 0x10, 0x10, 0x11, 0x0E]), // c
    Glyph::new([0x01, 0x01, 0x0F, 0x11, 0x11, 0x11, 0x0F]), // d
    Glyph::new([0x00, 0x00, 0x0E, 0x11, 0x1F, 0x10, 0x0E]), // e
    Glyph::new([0x06, 0x09, 0x08, 0x1C, 0x08, 0x08, 0x08]), // f
    Glyph::new([0x00, 0x00, 0x0F, 0x11, 0x0F, 0x01, 0x0E]), // g
    Glyph::new([0x10, 0x10, 0x1E, 0x11, 0x11, 0x11, 0x11]), // h
    Glyph::new([0x04, 0x00, 0x0C, 0x04, 0x04, 0x04, 0x0E]), // i
    Glyph::new([0x02, 0x00, 0x06, 0x02, 0x02, 0x12, 0x0C]), // j
    Glyph::new([0x10, 0x10, 0x12, 0x14, 0x18, 0x14, 0x12]), // k
    Glyph::new([0x0C, 0x04, 0x04, 0x04, 0x04, 0x04, 0x0E]), // l
    Glyph::new([0x00, 0x00, 0x1A, 0x15, 0x15, 0x15, 0x15]), // m
    Glyph::new([0x00, 0x00, 0x16, 0x19, 0x11, 0x11, 0x11]), // n
    Glyph::new([0x00, 0x00, 0x0E, 0x11, 0x11, 0x11, 0x0E]), // o
    Glyph::new([0x00, 0x00, 0x1E, 0x11, 0x1E, 0x10, 0x10]), // p
    Glyph::new([0x00, 0x00, 0x0F, 0x11, 0x0F, 0x01, 0x01]), // q
    Glyph::new([0x00, 0x00, 0x16, 0x19, 0x10, 0x10, 0x10]), // r
    Glyph::new([0x00, 0x00, 0x0E, 0x10, 0x0E, 0x01, 0x1E]), // s
    Glyph::new([0x08, 0x08, 0x1C, 0x08, 0x08, 0x09, 0x06]), // t
    Glyph::new([0x00, 0x00, 0x11, 0x11, 0x11, 0x13, 0x0D]), // u
    Glyph::new([0x00, 0x00, 0x11, 0x11, 0x11, 0x0A, 0x04]), // v
    Glyph::new([0x00, 0x00, 0x11, 0x15, 0x15, 0x15, 0x0A]), // w
    Glyph::new([0x00, 0x00, 0x11, 0x0A, 0x04, 0x0A, 0x11]), // x
    Glyph::new([0x00, 0x00, 0x11, 0x11, 0x0F, 0x01, 0x0E]), // y
    Glyph::new([0x00, 0x00, 0x1F, 0x02, 0x04, 0x08, 0x1F]), // z

    // 0x7B-0x7F
    Glyph::new([0x02, 0x04, 0x04, 0x08, 0x04, 0x04, 0x02]), // {
    Glyph::new([0x04, 0x04, 0x04, 0x04, 0x04, 0x04, 0x04]), // |
    Glyph::new([0x08, 0x04, 0x04, 0x02, 0x04, 0x04, 0x08]), // }
    Glyph::new([0x00, 0x00, 0x08, 0x15, 0x02, 0x00, 0x00]), // ~
    Glyph::new([0x1F, 0x1F, 0x1F, 0x1F, 0x1F, 0x1F, 0x1F]), // 0x7F (filled block)
];
